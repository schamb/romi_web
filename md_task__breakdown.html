<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ME405 Romi Doc: Task Breakdown</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ME405 Romi Doc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Task Breakdown</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md21"></a></p>
<hr  />
<h2><a class="anchor" id="autotoc_md23"></a>
Task Manager Class</h2>
<p>Tasks are created and managed by a TaskManager class. The class takes in 2 motors, 2 encoders, and an IMU. This way, the TaskManager can directly access the Romi’s sensors without having to pass them through queues or shares. When a TaskManager is initialized, it creates each task listed above and adds it to the scheduler. The tasks are run with a priority scheduler when TaskManager.run_tasks() is called.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md25"></a>
Task Priorities and Periods</h2>
<p>Calculating the priority and period of each task was mostly trial and error.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Task Name   </th><th class="markdownTableHeadNone">Period (ms)   </th><th class="markdownTableHeadNone">Priority    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_controller   </td><td class="markdownTableBodyNone">40   </td><td class="markdownTableBodyNone">5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_move   </td><td class="markdownTableBodyNone">25   </td><td class="markdownTableBodyNone">6    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_adjust_speed   </td><td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">7    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_update_position   </td><td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_read_line   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_bump   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">8   </td></tr>
</table>
<hr  />
<h2><a class="anchor" id="autotoc_md27"></a>
Scheduling and Unscheduling Tasks</h2>
<p>TaskManager uses flags to simulate scheduling and unscheduling tasks. Each task is a generator function with two while loops. The outer loop is an infinite loop that yields whenever the function is called. The inner while loop contains the task code and only runs when that task’s flag is set. If the flag is not set, the generator function skips the code in the inner loop and yields immediately, effectively “unscheduling” the task.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Task Name   </th><th class="markdownTableHeadNone">Flag    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_controller   </td><td class="markdownTableBodyNone">N/A    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_move   </td><td class="markdownTableBodyNone">move_flag    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_adjust_speed   </td><td class="markdownTableBodyNone">adjust_speed_flag    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_update_position   </td><td class="markdownTableBodyNone">update_position_flag    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">task_read_line   </td><td class="markdownTableBodyNone">read_line_flag    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">task_bump   </td><td class="markdownTableBodyNone">N/A   </td></tr>
</table>
<hr  />
<h2><a class="anchor" id="autotoc_md29"></a>
Task Control Flow Diagrams</h2>
<details >
<summary >
Controller</summary>
<p><img src="graphs/control.png" alt="Controller" class="inline"/> </p>
</details>
<details >
<summary >
Move</summary>
<p><img src="graphs/move.png" alt="Controller" class="inline"/> </p>
</details>
<details >
<summary >
Adjust Speed</summary>
<p><img src="graphs/speed.png" alt="Controller" class="inline"/> </p>
</details>
<details >
<summary >
Bump Sense</summary>
<p><img src="graphs/bump.png" alt="Controller" class="inline"/> </p>
</details>
<details >
<summary >
Line Sense</summary>
<p><img src="graphs/read.png" alt="Controller" class="inline"/> </p>
</details>
<h1><a class="anchor" id="autotoc_md30"></a>
</h1>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
